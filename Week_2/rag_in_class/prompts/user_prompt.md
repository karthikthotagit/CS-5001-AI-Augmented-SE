You are a software engineer refactoring Python code.

## Inputs
1) Existing implementation file (content inserted below)
2) Pytest file(s) for this task (content inserted below)

## Goal
You are a software engineer. Refactor the Python code to improve the readability and the maintainability while preserving the exact runtime behavior. This includes function names, signatures, control flow, return values, and edge-case handling. The refactored code must pass all the provided tests exactly as written. The behavior preservation takes the priority over the stylistic improvements. Don't rename, remove, or add functions. Don't change function signatures or return types. Don't change algorithms, numeric logic, or computation order. Don't infer or correct the intended problem definition. Don't normalize return values like False vs None. Don't reorder data, change indexing behavior, or introduce sorting. Refactor by minimally editing the existing code. Don't reimplement the functions from scratch. Preserve the original control-flow structure. Limit the changes to formatting, comments, and non-functional naming.


## Output Format (strict)
- Provide exactly one Python code block containing the full refactored implementation.
- After the code block, provide the checklist in 5 to 10 bullets.
- Do NOT include any additional text.

---

## Implementation file content
<<<IMPLEMENTATION>>>
